{% extends "base.html" %} {% block scripts %}

<script src="https://cdnjs.cloudflare.com/ajax/libs/showdown/2.1.0/showdown.min.js" integrity="sha512-LhccdVNGe2QMEfI3x4DVV3ckMRe36TfydKss6mJpdHjNFiV07dFpS2xzeZedptKZrwxfICJpez09iNioiSZ3hA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

{% endblock %} {% block content %}

<main class="">
    <h1 class="text-5xl">Collections</h1>
    <br>
    <br>
    <div id="listOfCollections" class="outline w-full lg:w-1/2 mx-auto overflow-y-scroll h-full rounded-md bg-accent p-5"></div>
</main>
<script>

    document.addEventListener('DOMContentLoaded', async () => {
        const container = document.getElementById('listOfCollections');
        const collections = await getCollections('{{ current_user.id }}');
        addCollections(collections, container);
    });

    async function getCollections(userId) {
        collections = await fetch(`/api/user/collections/${userId}`)
        
        collections = await collections.json()

        return collections
    }

    function addCollections(collections, container) {
        for (collection of collections) {
            a = document.createElement('a');
            a.href = `{{ url_for('collection', id=id)}}${collection.id}`
            const div = document.createElement('div');
            div.classList.add('p-5', 'rounded', 'bg-accent', 'outline', 'my-5');

            const h1 = document.createElement('h1');
            h1.classList.add('text-2xl');
            h1.innerText = collection.name || 'Untitled Collection';

            const p = document.createElement('p');
            p.classList.add('text-xl');
            p.innerText = `${collection.number_of_posts} posts`;

            div.append(h1);
            div.append(p);
            a.append(div);
            
            container.append(a);
        };
    }
</script>
{% endblock %}
